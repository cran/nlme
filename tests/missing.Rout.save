
R version 2.6.0 Under development (unstable) (2007-06-13 r41937)
Copyright (C) 2007 The R Foundation for Statistical Computing
ISBN 3-900051-07-0

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library(nlme)
> 
> options(digits=4) # avoid rounding differences
> 
> Ovary[c(1,272), 2] <- NA
> fm1 <- gls(follicles ~ sin(2*pi*Time) + cos(2*pi*Time), Ovary,
+            correlation = corAR1(form = ~ 1 | Mare), na.action=na.exclude)
> fitted(fm1)
     1      2      3      4      5      6      7      8      9     10     11 
    NA 12.856 12.061 11.271 10.551  9.960  9.544  9.338  9.359  9.604 10.054 
    12     13     14     15     16     17     18     19     20     21     22 
10.673 11.410 12.205 12.995 13.715 14.307 14.722 14.928 14.907 14.662 14.212 
    23     24     25     26     27     28     29     30     31     32     33 
13.593 12.856 12.061 11.271 10.551  9.960  9.544 13.794 13.010 12.141 11.271 
    34     35     36     37     38     39     40     41     42     43     44 
10.485  9.861  9.459  9.319  9.454  9.852 10.473 11.256 12.125 12.995 13.781 
    45     46     47     48     49     50     51     52     53     54     55 
14.405 14.807 14.947 14.812 14.414 13.794 13.010 12.141 11.271 10.485  9.861 
    56     57     58     59     60     61     62     63     64     65     66 
 9.459 13.904 13.098 12.188 11.271 10.448  9.807  9.419  9.325  9.535 10.026 
    67     68     69     70     71     72     73     74     75     76     77 
10.746 11.616 12.542 13.424 14.166 14.688 14.933 14.874 14.518 13.904 13.098 
    78     79     80     81     82     83     84     85     86     87     88 
12.188 11.271 10.448  9.807  9.419 13.593 12.856 12.061 11.271 10.551  9.960 
    89     90     91     92     93     94     95     96     97     98     99 
 9.544  9.338  9.359  9.604 10.054 10.673 11.410 12.205 12.995 13.715 14.307 
   100    101    102    103    104    105    106    107    108    109    110 
14.722 14.928 14.907 14.662 14.212 13.593 12.856 12.061 11.271 10.551  9.960 
   111    112    113    114    115    116    117    118    119    120    121 
 9.544 13.593 12.856 12.061 11.271 10.551  9.960  9.544  9.338  9.359  9.604 
   122    123    124    125    126    127    128    129    130    131    132 
10.054 10.673 11.410 12.205 12.995 13.715 14.307 14.722 14.928 14.907 14.662 
   133    134    135    136    137    138    139    140    141    142    143 
14.212 13.593 12.856 12.061 11.271 10.551  9.960  9.544 13.593 12.856 12.061 
   144    145    146    147    148    149    150    151    152    153    154 
11.271 10.551  9.960  9.544  9.338  9.359  9.604 10.054 10.673 11.410 12.205 
   155    156    157    158    159    160    161    162    163    164    165 
12.995 13.715 14.307 14.722 14.928 14.907 14.662 14.212 13.593 12.856 12.061 
   166    167    168    169    170    171    172    173    174    175    176 
11.271 10.551  9.960  9.544 13.794 13.010 12.141 11.271 10.485  9.861  9.459 
   177    178    179    180    181    182    183    184    185    186    187 
 9.319  9.454  9.852 10.473 11.256 12.125 12.995 13.781 14.405 14.807 14.947 
   188    189    190    191    192    193    194    195    196    197    198 
14.812 14.414 13.794 13.010 12.141 11.271 10.485  9.861  9.459 13.418 12.726 
   199    200    201    202    203    204    205    206    207    208    209 
11.994 11.271 10.607 10.047  9.629  9.382  9.322  9.454  9.769 10.244 10.848 
   210    211    212    213    214    215    216    217    218    219    220 
11.540 12.272 12.995 13.659 14.219 14.637 14.884 14.944 14.812 14.498 14.022 
   221    222    223    224    225    226    227    228    229    230    231 
13.418 12.726 11.994 11.271 10.607 10.047  9.629 14.022 13.195 12.239 11.271 
   232    233    234    235    236    237    238    239    240    241    242 
10.407  9.751  9.382  9.345  9.645 10.244 11.072 12.027 12.995 13.859 14.515 
   243    244    245    246    247    248    249    250    251    252    253 
14.884 14.921 14.622 14.022 13.195 12.239 11.271 10.407  9.751  9.382 13.593 
   254    255    256    257    258    259    260    261    262    263    264 
12.856 12.061 11.271 10.551  9.960  9.544  9.338  9.359  9.604 10.054 10.673 
   265    266    267    268    269    270    271    272    273    274    275 
11.410 12.205 12.995 13.715 14.307 14.722 14.928     NA 14.662 14.212 13.593 
   276    277    278    279    280    281    282    283    284    285    286 
12.856 12.061 11.271 10.551  9.960  9.544 13.794 13.010 12.141 11.271 10.485 
   287    288    289    290    291    292    293    294    295    296    297 
 9.861  9.459  9.319  9.454  9.852 10.473 11.256 12.125 12.995 13.781 14.405 
   298    299    300    301    302    303    304    305    306    307    308 
14.807 14.947 14.812 14.414 13.794 13.010 12.141 11.271 10.485  9.861  9.459 
attr(,"label")
[1] "Fitted values"
> residuals(fm1)
        1         2         3         4         5         6         7         8 
       NA   2.14386   6.93937   4.72901   2.44882   0.04046   2.45603   4.66184 
        9        10        11        12        13        14        15        16 
  3.64122  10.39585  11.94560   4.32695   6.59002   4.79451   1.00487   4.28507 
       17        18        19        20        21        22        23        24 
 -0.30658   1.27786   2.07205   3.09266   3.33803   2.78828   0.40693  -0.85614 
       25        26        27        28        29        30        31        32 
 -0.06063   2.72901  -0.55118   1.04046   6.45603  -7.79359  -7.01022  -4.14099 
       33        34        35        36        37        38        39        40 
 -4.27099   5.51463   0.13897   3.54090  -0.31891  -2.45420  -3.85170  -2.47253 
       41        42        43        44        45        46        47        48 
 -3.25589  -6.12512  -4.99513  -6.78075  -5.40508  -8.80702 -10.94720  -9.81192 
       49        50        51        52        53        54        55        56 
 -6.41441  -2.79359  -0.01022  -2.14099  -5.27099  -3.48537  -3.86103  -4.45910 
       57        58        59        60        61        62        63        64 
 -0.90420  -2.09816  -2.18752  -5.27099  -2.44787  -3.80737  -0.41890  -0.32454 
       65        66        67        68        69        70        71        72 
  0.46546  -2.02612   3.25398   1.38377   1.45755   2.57570   5.83377   6.31217 
       73        74        75        76        77        78        79        80 
 10.06742   8.12604   4.48168   8.09580   2.90184   8.81248   7.72901   9.55213 
       81        82        83        84        85        86        87        88 
  7.19263  14.58110  -4.59307  -3.85614  -5.06063  -5.27099  -3.55118  -3.95954 
       89        90        91        92        93        94        95        96 
 -8.54397  -8.33816  -8.35878  -4.60415  -4.05440  -7.67305  -6.40998  -9.20549 
       97        98        99       100       101       102       103       104 
 -6.99513  -5.71493  -8.30658  -9.72214  -8.92795  -6.90734  -3.66197  -0.21172 
      105       106       107       108       109       110       111       112 
 -5.59307  -3.85614  -2.06063  -4.27099  -3.55118  -3.95954   1.45603  -3.59307 
      113       114       115       116       117       118       119       120 
 -0.85614  -0.06063   5.72901  -1.55118   0.04046  -6.54397   2.66184   3.64122 
      121       122       123       124       125       126       127       128 
 -0.60415  -6.05440  -3.67305  -7.40998  -0.20549   1.00487  -1.71493   0.69342 
      129       130       131       132       133       134       135       136 
  2.27786   0.07205  -1.90734   3.33803   4.78828  -0.59307  -3.85614  -0.06063 
      137       138       139       140       141       142       143       144 
 -3.27099  -0.55118  -4.95954   4.45603   2.40693   4.14386   0.93937   5.72901 
      145       146       147       148       149       150       151       152 
  4.44882  -0.95954  -1.54397  -4.33816  -0.35878  -1.60415  -2.05440   2.32695 
      153       154       155       156       157       158       159       160 
  2.59002   0.79451   1.00487   0.28507  -3.30658   2.27786   6.07205   6.09266 
      161       162       163       164       165       166       167       168 
  6.33803   5.78828   3.40693   5.14386   9.93937  -1.27099   0.44882   1.04046 
      169       170       171       172       173       174       175       176 
  2.45603   4.20641  -0.01022   1.85901   0.72901   0.51463  -1.86103  -4.45910 
      177       178       179       180       181       182       183       184 
 -1.31891   0.54580   1.14830  -0.47253   0.74411  -2.12512  -3.99513  -1.78075 
      185       186       187       188       189       190       191       192 
 -0.40508   1.19298  -1.94720  -3.81192  -1.41441  -0.79359  -2.01022  -1.14099 
      193       194       195       196       197       198       199       200 
 -3.27099   3.51463  -5.86103  -2.45910  -0.41772  -3.72591   3.00630   3.72901 
      201       202       203       204       205       206       207       208 
  1.39298  -2.04705   0.37076  -3.38206  -0.32236  -1.45420   0.23140  -4.24413 
      209       210       211       212       213       214       215       216 
 -2.84839   1.45980  -0.27241  -0.99513   1.34090   6.78094  10.36312   6.11594 
      217       218       219       220       221       222       223       224 
  6.05624   9.18808   5.50248   5.97801   4.58228   7.27409   8.00630   7.72901 
      225       226       227       228       229       230       231       232 
  1.39298  -3.04706  -1.62924  -4.02199   0.80539  -0.23920  -1.27099  -3.40675 
      233       234       235       236       237       238       239       240 
  2.24927   0.61794  -1.34520   0.35541   4.75587   3.92850  -0.02691   6.00487 
      241       242       243       244       245       246       247       248 
  1.14063   1.48462   0.11594   2.07908  -0.62153   1.97801   1.80539  -1.23920 
      249       250       251       252       253       254       255       256 
 -1.27099  -3.40675  -5.75074  -1.38206  -2.59307   3.14386   2.93937   0.72901 
      257       258       259       260       261       262       263       264 
  0.44882  -3.95954   1.45603   2.66184   1.64122   6.39585   4.94560   0.32695 
      265       266       267       268       269       270       271       272 
 -4.40998   1.79451   7.00487   8.28507   8.69342   6.27786   6.07205        NA 
      273       274       275       276       277       278       279       280 
  7.33803   7.78828   3.40693   4.14386   4.93937   5.72901   3.44882   2.04046 
      281       282       283       284       285       286       287       288 
  1.45603  -4.79359  -5.01022  -4.14099  -3.27099  -2.48537  -3.86103  -2.45910 
      289       290       291       292       293       294       295       296 
 -1.31891   0.54580   0.14830   3.52747   1.74411  -4.12512  -4.99513  -5.78075 
      297       298       299       300       301       302       303       304 
 -5.40508   1.19298  -2.94720  -4.81192  -2.41441  -1.79359  -4.01022  -6.14099 
      305       306       307       308 
 -2.27099  -3.48537  -4.86103  -4.45910 
attr(,"std")
  [1]    NA 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581
 [13] 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581
 [25] 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581
 [37] 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581
 [49] 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581
 [61] 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581
 [73] 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581
 [85] 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581
 [97] 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581
[109] 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581
[121] 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581
[133] 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581
[145] 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581
[157] 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581
[169] 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581
[181] 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581
[193] 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581
[205] 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581
[217] 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581
[229] 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581
[241] 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581
[253] 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581
[265] 4.581 4.581 4.581 4.581 4.581 4.581 4.581    NA 4.581 4.581 4.581 4.581
[277] 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581
[289] 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581
[301] 4.581 4.581 4.581 4.581 4.581 4.581 4.581 4.581
attr(,"label")
[1] "Residuals"
> summary(fm1)
Generalized least squares fit by REML
  Model: follicles ~ sin(2 * pi * Time) + cos(2 * pi * Time) 
  Data: Ovary 
   AIC  BIC logLik
  1560 1579 -775.1

Correlation Structure: AR(1)
 Formula: ~1 | Mare 
 Parameter estimate(s):
   Phi 
0.7498 

Coefficients:
                    Value Std.Error t-value p-value
(Intercept)        12.133    0.6574  18.456  0.0000
sin(2 * pi * Time) -2.679    0.6436  -4.162  0.0000
cos(2 * pi * Time) -0.862    0.6902  -1.249  0.2126

 Correlation: 
                   (Intr) s(*p*T
sin(2 * pi * Time) -0.007       
cos(2 * pi * Time) -0.295  0.003

Standardized residuals:
     Min       Q1      Med       Q3      Max 
-2.38972 -0.75655 -0.01324  0.63960  3.18298 

Residual standard error: 4.581 
Degrees of freedom: 306 total; 303 residual
> 
> Orthodont[100:102, 2] <- NA
> fm2 <- lme(distance ~ age + Sex, data = Orthodont, random = ~ 1,
+            na.action=na.exclude)
> fitted(fm2, 0:1)
    fixed Subject
1   22.95   25.35
2   24.30   26.69
3   25.64   28.04
4   26.98   29.38
5   22.95   21.58
6   24.30   22.92
7   25.64   24.27
8   26.98   25.61
9   22.95   22.34
10  24.30   23.68
11  25.64   25.02
12  26.98   26.36
13  22.95   24.38
14  24.30   25.72
15  25.64   27.07
16  26.98   28.41
17  22.95   21.26
18  24.30   22.60
19  25.64   23.94
20  26.98   25.29
21  22.95   24.17
22  24.30   25.51
23  25.64   26.85
24  26.98   28.19
25  22.95   21.90
26  24.30   23.25
27  25.64   24.59
28  26.98   25.93
29  22.95   22.01
30  24.30   23.35
31  25.64   24.70
32  26.98   26.04
33  22.95   23.09
34  24.30   24.43
35  25.64   25.77
36  26.98   27.12
37  22.95   26.86
38  24.30   28.20
39  25.64   29.55
40  26.98   30.89
41  22.95   21.80
42  24.30   23.14
43  25.64   24.48
44  26.98   25.82
45  22.95   22.34
46  24.30   23.68
47  25.64   25.02
48  26.98   26.36
49  22.95   22.34
50  24.30   23.68
51  25.64   25.02
52  26.98   26.36
53  22.95   22.87
54  24.30   24.22
55  25.64   25.56
56  26.98   26.90
57  22.95   23.74
58  24.30   25.08
59  25.64   26.42
60  26.98   27.76
61  22.95   21.26
62  24.30   22.60
63  25.64   23.94
64  26.98   25.29
65  20.69   19.54
66  22.03   20.89
67  23.37   22.23
68  24.71   23.57
69  20.69   20.94
70  22.03   22.29
71  23.37   23.63
72  24.71   24.97
73  20.69   21.59
74  22.03   22.93
75  23.37   24.28
76  24.71   25.62
77  20.69   22.56
78  22.03   23.90
79  23.37   25.25
80  24.71   26.59
81  20.69   20.62
82  22.03   21.96
83  23.37   23.31
84  24.71   24.65
85  20.69   19.33
86  22.03   20.67
87  23.37   22.01
88  24.71   23.36
89  20.69   20.94
90  22.03   22.29
91  23.37   23.63
92  24.71   24.97
93  20.69   21.27
94  22.03   22.61
95  23.37   23.95
96  24.71   25.30
97  20.69   19.84
98  22.03   21.18
99  23.37   22.52
100    NA      NA
101    NA      NA
102    NA      NA
103 23.37   19.74
104 24.71   21.08
105 20.69   23.85
106 22.03   25.20
107 23.37   26.54
108 24.71   27.88
> fitted(fm2)
  M01   M01   M01   M01   M02   M02   M02   M02   M03   M03   M03   M03   M04 
25.35 26.69 28.04 29.38 21.58 22.92 24.27 25.61 22.34 23.68 25.02 26.36 24.38 
  M04   M04   M04   M05   M05   M05   M05   M06   M06   M06   M06   M07   M07 
25.72 27.07 28.41 21.26 22.60 23.94 25.29 24.17 25.51 26.85 28.19 21.90 23.25 
  M07   M07   M08   M08   M08   M08   M09   M09   M09   M09   M10   M10   M10 
24.59 25.93 22.01 23.35 24.70 26.04 23.09 24.43 25.77 27.12 26.86 28.20 29.55 
  M10   M11   M11   M11   M11   M12   M12   M12   M12   M13   M13   M13   M13 
30.89 21.80 23.14 24.48 25.82 22.34 23.68 25.02 26.36 22.34 23.68 25.02 26.36 
  M14   M14   M14   M14   M15   M15   M15   M15   M16   M16   M16   M16   F01 
22.87 24.22 25.56 26.90 23.74 25.08 26.42 27.76 21.26 22.60 23.94 25.29 19.54 
  F01   F01   F01   F02   F02   F02   F02   F03   F03   F03   F03   F04   F04 
20.89 22.23 23.57 20.94 22.29 23.63 24.97 21.59 22.93 24.28 25.62 22.56 23.90 
  F04   F04   F05   F05   F05   F05   F06   F06   F06   F06   F07   F07   F07 
25.25 26.59 20.62 21.96 23.31 24.65 19.33 20.67 22.01 23.36 20.94 22.29 23.63 
  F07   F08   F08   F08   F08   F09   F09   F09  <NA>  <NA>  <NA>   F10   F10 
24.97 21.27 22.61 23.95 25.30 19.84 21.18 22.52    NA    NA    NA 19.74 21.08 
  F11   F11   F11   F11 
23.85 25.20 26.54 27.88 
attr(,"label")
[1] "Fitted values (mm)"
> residuals(fm2, 0:1)
       fixed   Subject
1    3.04531  0.648269
2    0.70260 -1.694434
3    3.35990  0.962862
4    4.01719  1.620159
5   -1.45469 -0.081112
6   -1.79740 -0.423816
7   -2.64010 -1.266519
8   -0.48281  0.890777
9    0.04531  0.664764
10  -1.79740 -1.177940
11  -1.64010 -1.020643
12   0.51719  1.136654
13   2.54531  1.117857
14   3.20260  1.775153
15   0.85990 -0.567550
16   0.01719 -1.410254
17  -2.95469 -1.257916
18  -0.79740  0.899380
19  -3.14010 -1.443323
20  -0.98281  0.713973
21   1.54531  0.333321
22   1.20260 -0.009383
23   1.35990  0.147914
24   1.51719  0.305210
25  -0.95469  0.095692
26  -2.29740 -1.247012
27  -1.14010 -0.089715
28  -0.48281  0.567581
29   1.04531  1.987960
30  -2.79740 -1.854744
31  -1.14010 -0.197447
32  -1.48281 -0.540150
33   0.04531 -0.089360
34  -3.79740 -3.932063
35   5.35990  5.225233
36  -0.98281 -1.117470
37   4.54531  0.640022
38   3.70260 -0.202682
39   5.35990  1.454615
40   4.51719  0.611911
41   0.04531  1.203424
42  -1.29740 -0.139280
43  -2.14010 -0.981983
44  -1.98281 -0.824687
45  -1.45469 -0.835236
46  -0.79740 -0.177940
47  -1.64010 -1.020643
48   1.01719  1.636654
49  -5.95469 -5.335236
50   0.20260  0.822060
51   0.35990  0.979357
52   2.51719  3.136654
53  -0.45469 -0.373896
54   1.20260  1.283401
55  -0.14010 -0.059303
56  -0.98281 -0.902006
57   0.04531 -0.735752
58   0.20260 -0.578455
59   0.35990 -0.421158
60   3.01719  2.236138
61  -0.95469  0.742084
62  -2.79740 -1.100620
63  -2.14010 -0.443323
64  -1.98281 -0.286027
65   0.31353  1.455942
66  -2.02917 -0.886762
67  -1.87187 -0.729465
68  -1.71458 -0.572168
69   0.31353  0.055426
70  -0.52917 -0.787277
71   0.62813  0.370020
72   0.78542  0.527316
73  -0.18647 -1.090965
74   1.97083  1.066331
75   1.12813  0.223628
76   1.28542  0.380924
77   2.81353  0.939447
78   2.47083  0.596743
79   1.62813 -0.245960
80   1.78542 -0.088663
81   0.81353  0.878622
82   0.97083  1.035919
83  -0.87187 -0.806785
84  -1.21458 -1.149488
85  -0.68647  0.671406
86  -1.02917  0.328702
87  -2.37187 -1.014001
88  -2.21458 -0.856704
89   0.81353  0.555426
90   0.47083  0.212723
91  -0.37187 -0.629980
92   0.28542  0.027316
93   2.31353  1.732230
94   0.97083  0.389527
95   0.12813 -0.453176
96  -0.71458 -1.295880
97  -0.68647  0.161483
98  -1.02917 -0.181220
99  -1.37187 -0.523924
100       NA        NA
101       NA        NA
102       NA        NA
103 -4.37187 -0.742221
104 -5.21458 -1.584924
105  3.81353  0.646663
106  2.97083 -0.196040
107  4.62813  1.461257
108  3.28542  0.118553
> round(residuals(fm2), 2)
  M01   M01   M01   M01   M02   M02   M02   M02   M03   M03   M03   M03   M04 
 0.65 -1.69  0.96  1.62 -0.08 -0.42 -1.27  0.89  0.66 -1.18 -1.02  1.14  1.12 
  M04   M04   M04   M05   M05   M05   M05   M06   M06   M06   M06   M07   M07 
 1.78 -0.57 -1.41 -1.26  0.90 -1.44  0.71  0.33 -0.01  0.15  0.31  0.10 -1.25 
  M07   M07   M08   M08   M08   M08   M09   M09   M09   M09   M10   M10   M10 
-0.09  0.57  1.99 -1.85 -0.20 -0.54 -0.09 -3.93  5.23 -1.12  0.64 -0.20  1.45 
  M10   M11   M11   M11   M11   M12   M12   M12   M12   M13   M13   M13   M13 
 0.61  1.20 -0.14 -0.98 -0.82 -0.84 -0.18 -1.02  1.64 -5.34  0.82  0.98  3.14 
  M14   M14   M14   M14   M15   M15   M15   M15   M16   M16   M16   M16   F01 
-0.37  1.28 -0.06 -0.90 -0.74 -0.58 -0.42  2.24  0.74 -1.10 -0.44 -0.29  1.46 
  F01   F01   F01   F02   F02   F02   F02   F03   F03   F03   F03   F04   F04 
-0.89 -0.73 -0.57  0.06 -0.79  0.37  0.53 -1.09  1.07  0.22  0.38  0.94  0.60 
  F04   F04   F05   F05   F05   F05   F06   F06   F06   F06   F07   F07   F07 
-0.25 -0.09  0.88  1.04 -0.81 -1.15  0.67  0.33 -1.01 -0.86  0.56  0.21 -0.63 
  F07   F08   F08   F08   F08   F09   F09   F09  <NA>  <NA>  <NA>   F10   F10 
 0.03  1.73  0.39 -0.45 -1.30  0.16 -0.18 -0.52    NA    NA    NA -0.74 -1.58 
  F11   F11   F11   F11 
 0.65 -0.20  1.46  0.12 
attr(,"label")
[1] "Residuals (mm)"
> summary(fm2)
Linear mixed-effects model fit by REML
 Data: Orthodont 
    AIC   BIC logLik
  436.5 449.7 -213.3

Random effects:
 Formula: ~1 | Subject
        (Intercept) Residual
StdDev:       1.797    1.439

Fixed effects: distance ~ age + Sex 
             Value Std.Error DF t-value p-value
(Intercept) 17.584    0.8503 77  20.679  0.0000
age          0.671    0.0636 77  10.562  0.0000
SexFemale   -2.268    0.7616 25  -2.978  0.0064
 Correlation: 
          (Intr) age   
age       -0.822       
SexFemale -0.357 -0.006

Standardized Within-Group Residuals:
     Min       Q1      Med       Q3      Max 
-3.70787 -0.54714 -0.05637  0.46661  3.63142 

Number of Observations: 105
Number of Groups: 27 
> 
> Soybean[1:5, "Time"] <- NA
> fm3 <- gnls(weight ~ SSlogis(Time, Asym, xmid, scal), Soybean,
+             weights = varPower(), na.action=na.exclude)
> fitted(fm3)
      1       2       3       4       5       6       7       8       9      10 
     NA      NA      NA      NA      NA  7.0472 10.9577 14.0820 15.8940 16.7560 
     11      12      13      14      15      16      17      18      19      20 
 0.1203  0.2977  0.7259  1.7085  3.7237  7.0472 10.9577 15.8940 16.7560  0.1203 
     21      22      23      24      25      26      27      28      29      30 
 0.2977  0.7259  1.7085  3.7237  7.0472 10.9577 14.0820 15.8940 16.7560  0.1203 
     31      32      33      34      35      36      37      38      39      40 
 0.2977  0.7259  1.7085  3.7237  7.0472 10.9577 14.0820 15.8940 16.7560  0.1203 
     41      42      43      44      45      46      47      48      49      50 
 0.2977  0.7259  1.7085  3.7237  7.0472 10.9577 15.8940  0.1203  0.2977  0.7259 
     51      52      53      54      55      56      57      58      59      60 
 1.7085  3.7237  7.0472 10.9577 14.0820 15.8940 16.7560  0.1203  0.2977  0.7259 
     61      62      63      64      65      66      67      68      69      70 
 1.7085  3.7237  7.0472 10.9577 15.8940 16.7560  0.1203  0.2977  0.7259  1.7085 
     71      72      73      74      75      76      77      78      79      80 
 3.7237  7.0472 10.9577 14.0820 15.8940 16.7560  0.1203  0.2977  0.7259  1.7085 
     81      82      83      84      85      86      87      88      89      90 
 3.7237  7.0472 10.9577 14.0820 15.8940 16.7560  0.1203  0.2977  0.7259  1.7085 
     91      92      93      94      95      96      97      98      99     100 
 3.7237  7.0472 10.9577 14.0820 15.8940 16.7560  0.1203  0.2977  0.7259  1.7085 
    101     102     103     104     105     106     107     108     109     110 
 3.7237  7.0472 10.9577 14.0820 15.8940 16.7560  0.1203  0.2977  0.7259  1.7085 
    111     112     113     114     115     116     117     118     119     120 
 3.7237  7.0472 10.9577 14.0820 15.8940 16.7560  0.1203  0.2977  0.7259  1.7085 
    121     122     123     124     125     126     127     128     129     130 
 3.7237  7.0472 10.9577 14.0820 15.8940 16.7560  0.1203  0.2977  0.7259  1.7085 
    131     132     133     134     135     136     137     138     139     140 
 3.7237  7.0472 10.9577 14.0820 15.8940 16.7560  0.1203  0.2977  0.7259  1.7085 
    141     142     143     144     145     146     147     148     149     150 
 3.7237  7.0472 10.9577 14.0820 15.8940 16.7560  0.1203  0.2977  0.7259  1.7085 
    151     152     153     154     155     156     157     158     159     160 
 3.7237  7.0472 10.9577 14.0820 15.8940 16.7560  0.1203  0.2617  0.6401  1.5171 
    161     162     163     164     165     166     167     168     169     170 
 3.3548 10.4188 15.7056 17.1274  0.1203  0.2617  0.6401  1.5171  3.3548 10.4188 
    171     172     173     174     175     176     177     178     179     180 
15.7056 17.1274  0.1203  0.2617  0.6401  1.5171  3.3548 10.4188 15.7056 17.1274 
    181     182     183     184     185     186     187     188     189     190 
 0.1203  0.2617  0.6401  1.5171  3.3548 10.4188 15.7056 17.1274  0.1203  0.2617 
    191     192     193     194     195     196     197     198     199     200 
 0.6401  1.5171  3.3548 10.4188 15.7056 17.1274  0.1203  0.2617  0.6401  1.5171 
    201     202     203     204     205     206     207     208     209     210 
 3.3548 10.4188 15.7056 17.1274  0.1203  0.2617  0.6401  1.5171  3.3548 10.4188 
    211     212     213     214     215     216     217     218     219     220 
15.7056 17.1274  0.1203  0.2617  0.6401  1.5171  3.3548 10.4188 15.7056 17.1274 
    221     222     223     224     225     226     227     228     229     230 
 0.1203  0.2617  0.6401  1.5171  3.3548 10.4188 15.7056 17.1274  0.1203  0.2617 
    231     232     233     234     235     236     237     238     239     240 
 0.6401  1.5171  3.3548 10.4188 15.7056 17.1274  0.1203  0.2617  0.6401  1.5171 
    241     242     243     244     245     246     247     248     249     250 
 3.3548 10.4188 15.7056 17.1274  0.1203  0.2617  0.6401  1.5171  3.3548 10.4188 
    251     252     253     254     255     256     257     258     259     260 
15.7056 17.1274  0.1203  0.2617  0.6401  1.5171  3.3548 10.4188 15.7056 17.1274 
    261     262     263     264     265     266     267     268     269     270 
 0.1203  0.2617  0.6401  1.5171  3.3548 10.4188 15.7056 17.1274  0.1203  0.2617 
    271     272     273     274     275     276     277     278     279     280 
 0.6401  1.5171  3.3548 10.4188 15.7056 17.1274  0.1203  0.2617  0.6401  1.5171 
    281     282     283     284     285     286     287     288     289     290 
 3.3548 10.4188 15.7056 17.1274  0.1370  0.3849  0.9316  2.1566  4.1212  8.1661 
    291     292     293     294     295     296     297     298     299     300 
14.4182 16.8967  0.1370  0.3849  0.9316  2.1566  4.1212  8.1661 14.4182 16.8967 
    301     302     303     304     305     306     307     308     309     310 
 0.1370  0.3849  0.9316  2.1566  4.1212  8.1661 14.4182 16.8967  0.1370  0.3849 
    311     312     313     314     315     316     317     318     319     320 
 0.9316  2.1566  4.1212  8.1661 14.4182 16.8967  0.1370  0.3849  0.9316  2.1566 
    321     322     323     324     325     326     327     328     329     330 
 4.1212  8.1661 14.4182 16.8967  0.1370  0.3849  0.9316  2.1566  4.1212  8.1661 
    331     332     333     334     335     336     337     338     339     340 
14.4182 16.8967  0.1370  0.3849  0.9316  2.1566  4.1212  8.1661 14.4182 16.8967 
    341     342     343     344     345     346     347     348     349     350 
 0.1370  0.3849  0.9316  2.1566  4.1212  8.1661 14.4182 16.8967  0.1370  0.3849 
    351     352     353     354     355     356     357     358     359     360 
 0.9316  2.1566  4.1212  8.1661 14.4182 16.8967  0.1370  0.3849  0.9316  2.1566 
    361     362     363     364     365     366     367     368     369     370 
 4.1212  8.1661 14.4182 16.8967  0.1370  0.3849  0.9316  2.1566  4.1212  8.1661 
    371     372     373     374     375     376     377     378     379     380 
14.4182 16.8967  0.1370  0.3849  0.9316  2.1566  4.1212  8.1661 14.4182 16.8967 
    381     382     383     384     385     386     387     388     389     390 
 0.1370  0.3849  0.9316  2.1566  4.1212  8.1661 14.4182 16.8967  0.1370  0.3849 
    391     392     393     394     395     396     397     398     399     400 
 0.9316  2.1566  4.1212  8.1661 14.4182 16.8967  0.1370  0.3849  0.9316  2.1566 
    401     402     403     404     405     406     407     408     409     410 
 4.1212  8.1661 14.4182 16.8967  0.1370  0.3849  0.9316  2.1566  4.1212  8.1661 
    411     412 
14.4182 16.8967 
attr(,"label")
[1] "Fitted values (g)"
> residuals(fm3)
        1         2         3         4         5         6         7         8 
       NA        NA        NA        NA        NA -0.817235 -2.247725 -0.732029 
        9        10        11        12        13        14        15        16 
 0.447744  0.994846 -0.016267 -0.028703  0.052087  0.411533 -0.793662 -1.757235 
       17        18        19        20        21        22        23        24 
-1.457725  1.072744  0.990716 -0.012267 -0.006703 -0.058913  0.341533  0.086338 
       25        26        27        28        29        30        31        32 
-0.917235 -0.677725  3.997971  4.288544  5.054816 -0.015267  0.001297  0.118087 
       33        34        35        36        37        38        39        40 
-0.388467 -1.483662 -2.367235 -2.137725  1.007971 -1.233956 -2.751384 -0.019267 
       41        42        43        44        45        46        47        48 
-0.024703  0.122087  0.241533  1.046338 -1.037235 -1.047725  3.368344 -0.014267 
       49        50        51        52        53        54        55        56 
 0.039297 -0.026913 -0.178467  0.146338 -1.447235 -1.527725 -0.352029  1.486844 
       57        58        59        60        61        62        63        64 
 3.176316 -0.018267 -0.022703  0.041087 -0.258467  0.226338 -2.107235 -1.317725 
       65        66        67        68        69        70        71        72 
 1.986044  0.968216 -0.017267 -0.024703  0.016087 -0.298467 -0.713662 -1.787235 
       73        74        75        76        77        78        79        80 
-1.147725 -1.232029  2.320214  2.924016  0.010733  0.040297 -0.024913 -0.048467 
       81        82        83        84        85        86        87        88 
 0.526338  2.192765  1.192275  2.697971  0.031044  0.516316  0.007733  0.106297 
       89        90        91        92        93        94        95        96 
 0.171087  0.071533  0.186338  0.352765 -0.887725  4.777971  1.117744 10.614016 
       97        98        99       100       101       102       103       104 
 0.010733  0.081297  0.400087  0.731533  0.166338 -0.137235  1.532275  1.587971 
      105       106       107       108       109       110       111       112 
 7.869344  4.734816  0.033733  0.059297  0.455087  0.121533  0.986338  3.662765 
      113       114       115       116       117       118       119       120 
-1.047725  1.427971 -0.936056  5.044016  0.018733  0.030297  0.206087  0.281533 
      121       122       123       124       125       126       127       128 
-0.263662 -0.027235  0.832275  1.747971  0.026874  0.685716  0.018733  0.091297 
      129       130       131       132       133       134       135       136 
 0.368087  0.421533  0.316338  0.572765  1.522275  3.847971 -1.472256 13.515716 
      137       138       139       140       141       142       143       144 
 0.024733  0.068297  0.073087 -0.098467 -0.213662 -0.257235 -1.007725  0.457971 
      145       146       147       148       149       150       151       152 
 3.386044  5.816746  0.009733  0.057297  0.364087  0.571533  0.216338 -2.087235 
      153       154       155       156       157       158       159       160 
-0.037725 -0.062029  2.100244  5.614816 -0.073267 -0.125711 -0.367258 -0.533726 
      161       162       163       164       165       166       167       168 
-1.558134 -6.301675 -4.668445 -6.724066 -0.085267 -0.149711 -0.372091 -0.463729 
      169       170       171       172       173       174       175       176 
-1.639801 -3.690485 -5.392255 -6.039066 -0.076267 -0.115711 -0.279591 -0.742059 
      177       178       179       180       181       182       183       184 
-1.713134 -6.670485 -4.830585 -1.099896 -0.071267 -0.164711 -0.412591 -0.683726 
      185       186       187       188       189       190       191       192 
-2.000801 -4.430485 -5.120585 -6.215966 -0.081267 -0.140711 -0.368424 -0.858726 
      193       194       195       196       197       198       199       200 
-0.964801 -4.935482 -5.768915 -8.239066 -0.091267 -0.169711 -0.389091 -0.975392 
      201       202       203       204       205       206       207       208 
-2.293131 -5.588815 -9.433915 -8.544066 -0.079267 -0.116711 -0.234758 -0.757059 
      209       210       211       212       213       214       215       216 
-1.861468 -4.170485 -4.593885 -8.247396 -0.082267 -0.134711 -0.299924 -0.523059 
      217       218       219       220       221       222       223       224 
-1.073131 -1.912815 -6.732255 -5.495396 -0.050267 -0.053711 -0.039258  0.384608 
      225       226       227       228       229       230       231       232 
-0.389801 -2.275485 -0.005585  2.760904 -0.052267 -0.009711 -0.059591  0.496941 
      233       234       235       236       237       238       239       240 
-0.681468 -1.618815 -1.220585  5.515904 -0.043267 -0.037711 -0.298758  0.222941 
      241       242       243       244       245       246       247       248 
 1.169199  1.237885  4.611115  4.274604 -0.021267 -0.063711 -0.148924 -0.312059 
      249       250       251       252       253       254       255       256 
-0.554801 -3.055485 -0.563915  0.059274 -0.052267 -0.029711 -0.204091 -0.073726 
      257       258       259       260       261       262       263       264 
-0.094801 -2.210485  3.701115 -1.465726 -0.057267 -0.052711  0.100742 -0.248729 
      265       266       267       268       269       270       271       272 
 0.535199 -1.326815 -1.215585  1.967604  0.012733  0.041289  0.476909  0.662941 
      273       274       275       276       277       278       279       280 
 0.181866  2.741185  0.084415 -2.352396 -0.039267 -0.006711  0.124742 -0.423729 
      281       282       283       284       285       286       287       288 
-0.303131 -2.313815  8.718415  1.790904 -0.027755 -0.001035  0.230048  0.183443 
      289       290       291       292       293       294       295       296 
-1.251166  1.372212 -1.734896  1.736669 -0.041962 -0.046535 -0.173286  0.363443 
      297       298       299       300       301       302       303       304 
-1.602836 -3.049448 -5.843196 -2.723331 -0.048962  0.228299  0.383381  0.865113 
      305       306       307       308       309       310       311       312 
 1.728834 -0.749448 -3.086496 -0.013331 -0.048243  0.211799  0.143381  0.918443 
      313       314       315       316       317       318       319       320 
-0.162836 -2.132788 -3.981526  0.906639 -0.035662 -0.009535  0.990048  0.050113 
      321       322       323       324       325       326       327       328 
 0.643834  0.973882  1.421804  1.211639 -0.027197  0.098465  0.375048  1.798443 
      329       330       331       332       333       334       335       336 
 0.183834 -0.134448  1.665134  2.676639 -0.034019  0.029632  0.731714 -0.766557 
      337       338       339       340       341       342       343       344 
-1.119496 -1.321118  1.791804  2.176639 -0.060265 -0.013035 -0.186619  0.090110 
      345       346       347       348       349       350       351       352 
 0.373834 -2.491118  1.726804  2.035039  0.011779  0.302132  0.640051  1.656773 
      353       354       355       356       357       358       359       360 
 0.690504  3.487212  2.958504  1.000039  0.016797  0.209299  0.268381  0.988443 
      361       362       363       364       365       366       367       368 
-0.317836 -0.749448 -0.838196  3.963339 -0.012795  0.365465  0.526711  3.601773 
      369       370       371       372       373       374       375       376 
 1.875504  0.805552  2.653504  0.920039  0.041505  0.495965  0.450048  1.471776 
      377       378       379       380       381       382       383       384 
 1.072167 -2.976118  1.361804  4.645009  0.002185  0.070965  0.651711  1.898443 
      385       386       387       388       389       390       391       392 
 0.388834 -0.004448  4.296804  1.058339  0.025744  0.388799  0.043381  1.355113 
      393       394       395       396       397       398       399       400 
 0.388834 -0.382788  3.700134 -0.949991 -0.026529  0.071132  0.438381 -0.011557 
      401       402       403       404       405       406       407       408 
 1.708834  0.637212 -2.183196  0.888339  0.009038  0.178799  0.546711  0.445110 
      409       410       411       412 
 2.222164 -2.034448  1.993504  0.050039 
attr(,"std")
  [1]      NA      NA      NA      NA      NA 2.05137 3.02284 3.76791 4.19054
 [10] 4.38951 0.05745 0.12737 0.27864 0.59092 1.17142 2.05137 3.02284 4.19054
 [19] 4.38951 0.05745 0.12737 0.27864 0.59092 1.17142 2.05137 3.02284 3.76791
 [28] 4.19054 4.38951 0.05745 0.12737 0.27864 0.59092 1.17142 2.05137 3.02284
 [37] 3.76791 4.19054 4.38951 0.05745 0.12737 0.27864 0.59092 1.17142 2.05137
 [46] 3.02284 4.19054 0.05745 0.12737 0.27864 0.59092 1.17142 2.05137 3.02284
 [55] 3.76791 4.19054 4.38951 0.05745 0.12737 0.27864 0.59092 1.17142 2.05137
 [64] 3.02284 4.19054 4.38951 0.05745 0.12737 0.27864 0.59092 1.17142 2.05137
 [73] 3.02284 3.76791 4.19054 4.38951 0.05745 0.12737 0.27864 0.59092 1.17142
 [82] 2.05137 3.02284 3.76791 4.19054 4.38951 0.05745 0.12737 0.27864 0.59092
 [91] 1.17142 2.05137 3.02284 3.76791 4.19054 4.38951 0.05745 0.12737 0.27864
[100] 0.59092 1.17142 2.05137 3.02284 3.76791 4.19054 4.38951 0.05745 0.12737
[109] 0.27864 0.59092 1.17142 2.05137 3.02284 3.76791 4.19054 4.38951 0.05745
[118] 0.12737 0.27864 0.59092 1.17142 2.05137 3.02284 3.76791 4.19054 4.38951
[127] 0.05745 0.12737 0.27864 0.59092 1.17142 2.05137 3.02284 3.76791 4.19054
[136] 4.38951 0.05745 0.12737 0.27864 0.59092 1.17142 2.05137 3.02284 3.76791
[145] 4.19054 4.38951 0.05745 0.12737 0.27864 0.59092 1.17142 2.05137 3.02284
[154] 3.76791 4.19054 4.38951 0.05745 0.11374 0.24949 0.53236 1.06887 2.89187
[163] 4.14689 4.47486 0.05745 0.11374 0.24949 0.53236 1.06887 2.89187 4.14689
[172] 4.47486 0.05745 0.11374 0.24949 0.53236 1.06887 2.89187 4.14689 4.47486
[181] 0.05745 0.11374 0.24949 0.53236 1.06887 2.89187 4.14689 4.47486 0.05745
[190] 0.11374 0.24949 0.53236 1.06887 2.89187 4.14689 4.47486 0.05745 0.11374
[199] 0.24949 0.53236 1.06887 2.89187 4.14689 4.47486 0.05745 0.11374 0.24949
[208] 0.53236 1.06887 2.89187 4.14689 4.47486 0.05745 0.11374 0.24949 0.53236
[217] 1.06887 2.89187 4.14689 4.47486 0.05745 0.11374 0.24949 0.53236 1.06887
[226] 2.89187 4.14689 4.47486 0.05745 0.11374 0.24949 0.53236 1.06887 2.89187
[235] 4.14689 4.47486 0.05745 0.11374 0.24949 0.53236 1.06887 2.89187 4.14689
[244] 4.47486 0.05745 0.11374 0.24949 0.53236 1.06887 2.89187 4.14689 4.47486
[253] 0.05745 0.11374 0.24949 0.53236 1.06887 2.89187 4.14689 4.47486 0.05745
[262] 0.11374 0.24949 0.53236 1.06887 2.89187 4.14689 4.47486 0.05745 0.11374
[271] 0.24949 0.53236 1.06887 2.89187 4.14689 4.47486 0.05745 0.11374 0.24949
[280] 0.53236 1.06887 2.89187 4.14689 4.47486 0.06440 0.15959 0.34691 0.72506
[289] 1.28057 2.33481 3.84680 4.42186 0.06440 0.15959 0.34691 0.72506 1.28057
[298] 2.33481 3.84680 4.42186 0.06440 0.15959 0.34691 0.72506 1.28057 2.33481
[307] 3.84680 4.42186 0.06440 0.15959 0.34691 0.72506 1.28057 2.33481 3.84680
[316] 4.42186 0.06440 0.15959 0.34691 0.72506 1.28057 2.33481 3.84680 4.42186
[325] 0.06440 0.15959 0.34691 0.72506 1.28057 2.33481 3.84680 4.42186 0.06440
[334] 0.15959 0.34691 0.72506 1.28057 2.33481 3.84680 4.42186 0.06440 0.15959
[343] 0.34691 0.72506 1.28057 2.33481 3.84680 4.42186 0.06440 0.15959 0.34691
[352] 0.72506 1.28057 2.33481 3.84680 4.42186 0.06440 0.15959 0.34691 0.72506
[361] 1.28057 2.33481 3.84680 4.42186 0.06440 0.15959 0.34691 0.72506 1.28057
[370] 2.33481 3.84680 4.42186 0.06440 0.15959 0.34691 0.72506 1.28057 2.33481
[379] 3.84680 4.42186 0.06440 0.15959 0.34691 0.72506 1.28057 2.33481 3.84680
[388] 4.42186 0.06440 0.15959 0.34691 0.72506 1.28057 2.33481 3.84680 4.42186
[397] 0.06440 0.15959 0.34691 0.72506 1.28057 2.33481 3.84680 4.42186 0.06440
[406] 0.15959 0.34691 0.72506 1.28057 2.33481 3.84680 4.42186
attr(,"label")
[1] "Residuals (g)"
> summary(fm3)
Generalized nonlinear least squares fit
  Model: weight ~ SSlogis(Time, Asym, xmid, scal) 
  Data: Soybean 
    AIC  BIC logLik
  987.3 1007 -488.6

Variance function:
 Structure: Power of variance covariate
 Formula: ~fitted(.) 
 Parameter estimates:
 power 
0.8783 

Coefficients:
     Value Std.Error t-value p-value
Asym 17.38    0.5251   33.11       0
xmid 51.93    0.5982   86.80       0
scal  7.64    0.1415   53.96       0

 Correlation: 
     Asym  xmid 
xmid 0.788      
scal 0.488 0.842

Standardized residuals:
      Min        Q1       Med        Q3       Max 
-2.306636 -0.654470 -0.001905  0.501223  4.967561 

Residual standard error: 0.3692 
Degrees of freedom: 407 total; 404 residual
> 
